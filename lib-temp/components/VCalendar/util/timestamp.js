export const PARSE_REGEX = /^(\d{4})-(\d{1,2})(-(\d{1,2}))?([^\d]+(\d{1,2}))?(:(\d{1,2}))?(:(\d{1,2}))?$/;
export const PARSE_TIME = /(\d\d?)(:(\d\d?)|)(:(\d\d?)|)/;
export const DAYS_IN_MONTH = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
export const DAYS_IN_MONTH_LEAP = [0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
export const DAYS_IN_MONTH_MIN = 28;
export const DAYS_IN_MONTH_MAX = 31;
export const MONTH_MAX = 12;
export const MONTH_MIN = 1;
export const DAY_MIN = 1;
export const DAYS_IN_WEEK = 7;
export const MINUTES_IN_HOUR = 60;
export const HOURS_IN_DAY = 24;
export const FIRST_HOUR = 0;
export function getStartOfWeek(timestamp, weekdays, today) {
    const start = copyTimestamp(timestamp);
    findWeekday(start, weekdays[0], prevDay);
    updateFormatted(start);
    if (today) {
        updateRelative(start, today, start.hasTime);
    }
    return start;
}
export function getEndOfWeek(timestamp, weekdays, today) {
    const end = copyTimestamp(timestamp);
    findWeekday(end, weekdays[weekdays.length - 1]);
    updateFormatted(end);
    if (today) {
        updateRelative(end, today, end.hasTime);
    }
    return end;
}
export function getStartOfMonth(timestamp) {
    const start = copyTimestamp(timestamp);
    start.day = DAY_MIN;
    updateWeekday(start);
    updateFormatted(start);
    return start;
}
export function getEndOfMonth(timestamp) {
    const end = copyTimestamp(timestamp);
    end.day = daysInMonth(end.year, end.month);
    updateWeekday(end);
    updateFormatted(end);
    return end;
}
export function parseTime(input) {
    if (typeof input === 'number') {
        // when a number is given, it's minutes since 12:00am
        return input;
    }
    else if (typeof input === 'string') {
        // when a string is given, it's a hh:mm:ss format where seconds are optional
        const parts = PARSE_TIME.exec(input);
        if (!parts) {
            return false;
        }
        return parseInt(parts[1]) * 60 + parseInt(parts[3] || 0);
    }
    else if (typeof input === 'object') {
        // when an object is given, it must have hour and minute
        if (typeof input.hour !== 'number' || typeof input.minute !== 'number') {
            return false;
        }
        return input.hour * 60 + input.minute;
    }
    else {
        // unsupported type
        return false;
    }
}
export function validateTimestamp(input) {
    return !!PARSE_REGEX.exec(input);
}
export function parseTimestamp(input, now) {
    // YYYY-MM-DD hh:mm:ss
    const parts = PARSE_REGEX.exec(input);
    if (!parts)
        return null;
    const timestamp = {
        date: input,
        time: '',
        year: parseInt(parts[1]),
        month: parseInt(parts[2]),
        day: parseInt(parts[4]) || 1,
        hour: parseInt(parts[6]) || 0,
        minute: parseInt(parts[8]) || 0,
        weekday: 0,
        hasDay: !!parts[4],
        hasTime: !!(parts[6] && parts[8]),
        past: false,
        present: false,
        future: false
    };
    updateWeekday(timestamp);
    updateFormatted(timestamp);
    if (now) {
        updateRelative(timestamp, now, timestamp.hasTime);
    }
    return timestamp;
}
export function parseDate(date) {
    return updateFormatted({
        date: '',
        time: '',
        year: date.getFullYear(),
        month: date.getMonth() + 1,
        day: date.getDate(),
        weekday: date.getDay(),
        hour: date.getHours(),
        minute: date.getMinutes(),
        hasDay: true,
        hasTime: true,
        past: false,
        present: true,
        future: false
    });
}
export function getDayIdentifier(timestamp) {
    return timestamp.year * 10000 + timestamp.month * 100 + timestamp.day;
}
export function getTimeIdentifier(timestamp) {
    return timestamp.hour * 100 + timestamp.minute;
}
export function updateRelative(timestamp, now, time = false) {
    let a = getDayIdentifier(now);
    let b = getDayIdentifier(timestamp);
    let present = a === b;
    if (timestamp.hasTime && time && present) {
        a = getTimeIdentifier(now);
        b = getTimeIdentifier(timestamp);
        present = a === b;
    }
    timestamp.past = b < a;
    timestamp.present = present;
    timestamp.future = b > a;
    return timestamp;
}
export function updateMinutes(timestamp, minutes, now) {
    timestamp.hasTime = true;
    timestamp.hour = Math.floor(minutes / MINUTES_IN_HOUR);
    timestamp.minute = minutes % MINUTES_IN_HOUR;
    timestamp.time = getTime(timestamp);
    if (now) {
        updateRelative(timestamp, now, true);
    }
    return timestamp;
}
export function updateWeekday(timestamp) {
    timestamp.weekday = getWeekday(timestamp);
    return timestamp;
}
export function updateFormatted(timestamp) {
    timestamp.time = getTime(timestamp);
    timestamp.date = getDate(timestamp);
    return timestamp;
}
export function getWeekday(timestamp) {
    if (timestamp.hasDay) {
        const _ = Math.floor;
        const k = timestamp.day;
        const m = ((timestamp.month + 9) % MONTH_MAX) + 1;
        const C = _(timestamp.year / 100);
        const Y = (timestamp.year % 100) - (timestamp.month <= 2 ? 1 : 0);
        return (((k + _(2.6 * m - 0.2) - 2 * C + Y + _(Y / 4) + _(C / 4)) % 7) + 7) % 7;
    }
    return timestamp.weekday;
}
export function isLeapYear(year) {
    return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0);
}
export function daysInMonth(year, month) {
    return isLeapYear(year) ? DAYS_IN_MONTH_LEAP[month] : DAYS_IN_MONTH[month];
}
export function copyTimestamp(timestamp) {
    const { date, time, year, month, day, weekday, hour, minute, hasDay, hasTime, past, present, future } = timestamp;
    return { date, time, year, month, day, weekday, hour, minute, hasDay, hasTime, past, present, future };
}
export function padNumber(x, length) {
    let padded = String(x);
    while (padded.length < length) {
        padded = '0' + padded;
    }
    return padded;
}
export function getDate(timestamp) {
    let str = `${padNumber(timestamp.year, 4)}-${padNumber(timestamp.month, 2)}`;
    if (timestamp.hasDay)
        str += `-${padNumber(timestamp.day, 2)}`;
    return str;
}
export function getTime(timestamp) {
    if (!timestamp.hasTime) {
        return '';
    }
    return `${padNumber(timestamp.hour, 2)}:${padNumber(timestamp.minute, 2)}`;
}
export function nextMinutes(timestamp, minutes) {
    timestamp.minute += minutes;
    while (timestamp.minute > MINUTES_IN_HOUR) {
        timestamp.minute -= MINUTES_IN_HOUR;
        timestamp.hour++;
        if (timestamp.hour >= HOURS_IN_DAY) {
            nextDay(timestamp);
            timestamp.hour = FIRST_HOUR;
        }
    }
    return timestamp;
}
export function nextDay(timestamp) {
    timestamp.day++;
    timestamp.weekday = (timestamp.weekday + 1) % DAYS_IN_WEEK;
    if (timestamp.day > DAYS_IN_MONTH_MIN && timestamp.day > daysInMonth(timestamp.year, timestamp.month)) {
        timestamp.day = DAY_MIN;
        timestamp.month++;
        if (timestamp.month > MONTH_MAX) {
            timestamp.month = MONTH_MIN;
            timestamp.year++;
        }
    }
    return timestamp;
}
export function prevDay(timestamp) {
    timestamp.day--;
    timestamp.weekday = (timestamp.weekday + 6) % DAYS_IN_WEEK;
    if (timestamp.day < DAY_MIN) {
        timestamp.month--;
        if (timestamp.month < MONTH_MIN) {
            timestamp.year--;
            timestamp.month = MONTH_MAX;
        }
        timestamp.day = daysInMonth(timestamp.year, timestamp.month);
    }
    return timestamp;
}
export function relativeDays(timestamp, mover = nextDay, days = 1) {
    while (--days >= 0)
        mover(timestamp);
    return timestamp;
}
export function findWeekday(timestamp, weekday, mover = nextDay, maxDays = 6) {
    while (timestamp.weekday !== weekday && --maxDays >= 0)
        mover(timestamp);
    return timestamp;
}
export function getWeekdaySkips(weekdays) {
    const skips = [1, 1, 1, 1, 1, 1, 1];
    const filled = [0, 0, 0, 0, 0, 0, 0];
    for (let i = 0; i < weekdays.length; i++) {
        filled[weekdays[i]] = 1;
    }
    for (let k = 0; k < DAYS_IN_WEEK; k++) {
        let skip = 1;
        for (let j = 1; j < DAYS_IN_WEEK; j++) {
            const next = (k + j) % DAYS_IN_WEEK;
            if (filled[next]) {
                break;
            }
            skip++;
        }
        skips[k] = filled[k] * skip;
    }
    return skips;
}
export function createDayList(start, end, now, weekdaySkips, max = 42, min = 0) {
    const stop = getDayIdentifier(end);
    const days = [];
    let current = copyTimestamp(start);
    let currentIdentifier = 0;
    let stopped = currentIdentifier === stop;
    if (stop < getDayIdentifier(start)) {
        return days;
    }
    while ((!stopped || days.length < min) && days.length < max) {
        currentIdentifier = getDayIdentifier(current);
        stopped = stopped || currentIdentifier === stop;
        if (weekdaySkips[current.weekday] === 0) {
            current = nextDay(current);
            continue;
        }
        const day = copyTimestamp(current);
        updateFormatted(day);
        updateRelative(day, now);
        days.push(day);
        current = relativeDays(current, nextDay, weekdaySkips[current.weekday]);
    }
    return days;
}
export function createIntervalList(timestamp, first, minutes, count, now) {
    const intervals = [];
    for (let i = 0; i < count; i++) {
        const mins = (first + i) * minutes;
        const int = copyTimestamp(timestamp);
        intervals.push(updateMinutes(int, mins, now));
    }
    return intervals;
}
export function createNativeLocaleFormatter(locale, getOptions) {
    const emptyFormatter = (_t, _s) => '';
    if (typeof Intl === 'undefined' || typeof Intl.DateTimeFormat === 'undefined') {
        return emptyFormatter;
    }
    return (timestamp, short) => {
        try {
            const intlFormatter = new Intl.DateTimeFormat(locale || undefined, getOptions(timestamp, short));
            const time = `${padNumber(timestamp.hour, 2)}:${padNumber(timestamp.minute, 2)}`;
            const date = timestamp.date;
            return intlFormatter.format(new Date(`${date}T${time}:00+00:00`));
        }
        catch (e) {
            return '';
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZXN0YW1wLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVkNhbGVuZGFyL3V0aWwvdGltZXN0YW1wLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE1BQU0sQ0FBQyxNQUFNLFdBQVcsR0FBVyw4RUFBOEUsQ0FBQTtBQUNqSCxNQUFNLENBQUMsTUFBTSxVQUFVLEdBQVcsK0JBQStCLENBQUE7QUFFakUsTUFBTSxDQUFDLE1BQU0sYUFBYSxHQUFhLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUE7QUFDMUYsTUFBTSxDQUFDLE1BQU0sa0JBQWtCLEdBQWEsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQTtBQUMvRixNQUFNLENBQUMsTUFBTSxpQkFBaUIsR0FBRyxFQUFFLENBQUE7QUFDbkMsTUFBTSxDQUFDLE1BQU0saUJBQWlCLEdBQUcsRUFBRSxDQUFBO0FBQ25DLE1BQU0sQ0FBQyxNQUFNLFNBQVMsR0FBRyxFQUFFLENBQUE7QUFDM0IsTUFBTSxDQUFDLE1BQU0sU0FBUyxHQUFHLENBQUMsQ0FBQTtBQUMxQixNQUFNLENBQUMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFBO0FBQ3hCLE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBRyxDQUFDLENBQUE7QUFDN0IsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFHLEVBQUUsQ0FBQTtBQUNqQyxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsRUFBRSxD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QUFDLE1BQU0sSUFBSSxTQUFTLEVBQUUsVUFBVSxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFBO1lBQ2hHLE1BQU0sSUFBSSxHQUFHLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksU0FBUyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtZQUNoRixNQUFNLElBQUksR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFBO1lBQzNCLE9BQU8sYUFBYSxDQUFDLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxHQUFHLElBQUksSUFBSSxJQUFJLFdBQVcsQ0FBQyxDQUFDLENBQUE7U0FDbEU7UUFBQyxPQUFPLENBQUMsRUFBRTtZQUNWLE9BQU8sRUFBRSxDQUFBO1NBQ1Y7SUFDSCxDQUFDLENBQUE7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmV4cG9ydCBjb25zdCBQQVJTRV9SRUdFWDogUmVnRXhwID0gL14oXFxkezR9KS0oXFxkezEsMn0pKC0oXFxkezEsMn0pKT8oW15cXGRdKyhcXGR7MSwyfSkpPyg6KFxcZHsxLDJ9KSk/KDooXFxkezEsMn0pKT8kL1xyXG5leHBvcnQgY29uc3QgUEFSU0VfVElNRTogUmVnRXhwID0gLyhcXGRcXGQ/KSg6KFxcZFxcZD8pfCkoOihcXGRcXGQ/KXwpL1xyXG5cclxuZXhwb3J0IGNvbnN0IERBWVNfSU5fTU9OVEg6IG51bWJlcltdID0gWzAsIDMxLCAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdXHJcbmV4cG9ydCBjb25zdCBEQVlTX0lOX01PTlRIX0xFQVA6IG51bWJlcltdID0gWzAsIDMxLCAyOSwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdXHJcbmV4cG9ydCBjb25zdCBEQVlTX0lOX01PTlRIX01JTiA9IDI4XHJcbmV4cG9ydCBjb25zdCBEQVlTX0lOX01PTlRIX01BWCA9IDMxXHJcbmV4cG9ydCBjb25zdCBNT05USF9NQVggPSAxMlxyXG5leHBvcnQgY29uc3QgTU9OVEhfTUlOID0gMVxyXG5leHBvcnQgY29uc3QgREFZX01JTiA9IDFcclxuZXhwb3J0IGNvbnN0IERBWVNfSU5fV0VFSyA9IDdcclxuZXhwb3J0IGNvbnN0IE1JTlVURVNfSU5fSE9VUiA9IDYwXHJcbmV4cG9ydCBjb25zdCBIT1VSU19JTl9EQVkgPSAyNFxyXG5leHBvcnQgY29uc3QgRklSU1RfSE9VUiA9IDBcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVlRpbWVzdGFtcCB7XHJcbiAgZGF0ZTogc3RyaW5nXHJcbiAgdGltZTogc3RyaW5nXHJcbiAgeWVhcjogbnVtYmVyXHJcbiAgbW9udGg6IG51bWJlclxyXG4gIGRheTogbnVtYmVyXHJcbiAgd2Vla2RheTogbnVtYmVyXHJcbiAgaG91cjogbnVtYmVyXHJcbiAgbWludXRlOiBudW1iZXJcclxuICBoYXNEYXk6IGJvb2xlYW5cclxuICBoYXNUaW1lOiBib29sZWFuXHJcbiAgcGFzdDogYm9vbGVhblxyXG4gIHByZXNlbnQ6IGJvb2xlYW5cclxuICBmdXR1cmU6IGJvb2xlYW5cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBWVGltZU9iamVjdCB7XHJcbiAgaG91cjogbnVtYmVyXHJcbiAgbWludXRlOiBudW1iZXJcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgVlRpbWUgPSBudW1iZXIgfCBzdHJpbmcgfCBWVGltZU9iamVjdFxyXG5cclxuZXhwb3J0IHR5cGUgVlRpbWVzdGFtcEZvcm1hdHRlciA9ICh0aW1lc3RhbXA6IFZUaW1lc3RhbXAsIHNob3J0OiBib29sZWFuKSA9PiBzdHJpbmdcclxuXHJcbmV4cG9ydCB0eXBlIFZUaW1lc3RhbXBGb3JtYXRPcHRpb25zID0gKHRpbWVzdGFtcDogVlRpbWVzdGFtcCwgc2hvcnQ6IGJvb2xlYW4pID0+IG9iamVjdFxyXG5cclxuZXhwb3J0IHR5cGUgVlRpbWVzdGFtcE9wZXJhdGlvbiA9ICh0aW1lc3RhbXA6IFZUaW1lc3RhbXApID0+IFZUaW1lc3RhbXBcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdGFydE9mV2VlayAodGltZXN0YW1wOiBWVGltZXN0YW1wLCB3ZWVrZGF5czogbnVtYmVyW10sIHRvZGF5PzogVlRpbWVzdGFtcCk6IFZUaW1lc3RhbXAge1xyXG4gIGNvbnN0IHN0YXJ0ID0gY29weVRpbWVzdGFtcCh0aW1lc3RhbXApXHJcbiAgZmluZFdlZWtkYXkoc3RhcnQsIHdlZWtkYXlzWzBdLCBwcmV2RGF5KVxyXG4gIHVwZGF0ZUZvcm1hdHRlZChzdGFydClcclxuICBpZiAodG9kYXkpIHtcclxuICAgIHVwZGF0ZVJlbGF0aXZlKHN0YXJ0LCB0b2RheSwgc3RhcnQuaGFzVGltZSlcclxuICB9XHJcbiAgcmV0dXJuIHN0YXJ0XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbmRPZldlZWsgKHRpbWVzdGFtcDogVlRpbWVzdGFtcCwgd2Vla2RheXM6IG51bWJlcltdLCB0b2RheT86IFZUaW1lc3RhbXApOiBWVGltZXN0YW1wIHtcclxuICBjb25zdCBlbmQgPSBjb3B5VGltZXN0YW1wKHRpbWVzdGFtcClcclxuICBmaW5kV2Vla2RheShlbmQsIHdlZWtkYXlzW3dlZWtkYXlzLmxlbmd0aCAtIDFdKVxyXG4gIHVwZGF0ZUZvcm1hdHRlZChlbmQpXHJcbiAgaWYgKHRvZGF5KSB7XHJcbiAgICB1cGRhdGVSZWxhdGl2ZShlbmQsIHRvZGF5LCBlbmQuaGFzVGltZSlcclxuICB9XHJcbiAgcmV0dXJuIGVuZFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RhcnRPZk1vbnRoICh0aW1lc3RhbXA6IFZUaW1lc3RhbXApOiBWVGltZXN0YW1wIHtcclxuICBjb25zdCBzdGFydCA9IGNvcHlUaW1lc3RhbXAodGltZXN0YW1wKVxyXG4gIHN0YXJ0LmRheSA9IERBWV9NSU5cclxuICB1cGRhdGVXZWVrZGF5KHN0YXJ0KVxyXG4gIHVwZGF0ZUZvcm1hdHRlZChzdGFydClcclxuICByZXR1cm4gc3RhcnRcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVuZE9mTW9udGggKHRpbWVzdGFtcDogVlRpbWVzdGFtcCk6IFZUaW1lc3RhbXAge1xyXG4gIGNvbnN0IGVuZCA9IGNvcHlUaW1lc3RhbXAodGltZXN0YW1wKVxyXG4gIGVuZC5kYXkgPSBkYXlzSW5Nb250aChlbmQueWVhciwgZW5kLm1vbnRoKVxyXG4gIHVwZGF0ZVdlZWtkYXkoZW5kKVxyXG4gIHVwZGF0ZUZvcm1hdHRlZChlbmQpXHJcbiAgcmV0dXJuIGVuZFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VUaW1lIChpbnB1dDogYW55KTogbnVtYmVyIHwgZmFsc2Uge1xyXG4gIGlmICh0eXBlb2YgaW5wdXQgPT09ICdudW1iZXInKSB7XHJcbiAgICAvLyB3aGVuIGEgbnVtYmVyIGlzIGdpdmVuLCBpdCdzIG1pbnV0ZXMgc2luY2UgMTI6MDBhbVxyXG4gICAgcmV0dXJuIGlucHV0XHJcbiAgfSBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAvLyB3aGVuIGEgc3RyaW5nIGlzIGdpdmVuLCBpdCdzIGEgaGg6bW06c3MgZm9ybWF0IHdoZXJlIHNlY29uZHMgYXJlIG9wdGlvbmFsXHJcbiAgICBjb25zdCBwYXJ0cyA9IFBBUlNFX1RJTUUuZXhlYyhpbnB1dClcclxuICAgIGlmICghcGFydHMpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gcGFyc2VJbnQocGFydHNbMV0pICogNjAgKyBwYXJzZUludChwYXJ0c1szXSB8fCAwKVxyXG4gIH0gZWxzZSBpZiAodHlwZW9mIGlucHV0ID09PSAnb2JqZWN0Jykge1xyXG4gICAgLy8gd2hlbiBhbiBvYmplY3QgaXMgZ2l2ZW4sIGl0IG11c3QgaGF2ZSBob3VyIGFuZCBtaW51dGVcclxuICAgIGlmICh0eXBlb2YgaW5wdXQuaG91ciAhPT0gJ251bWJlcicgfHwgdHlwZW9mIGlucHV0Lm1pbnV0ZSAhPT0gJ251bWJlcicpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gaW5wdXQuaG91ciAqIDYwICsgaW5wdXQubWludXRlXHJcbiAgfSBlbHNlIHtcclxuICAgIC8vIHVuc3VwcG9ydGVkIHR5cGVcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlVGltZXN0YW1wIChpbnB1dDogYW55KTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuICEhUEFSU0VfUkVHRVguZXhlYyhpbnB1dClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVGltZXN0YW1wIChpbnB1dDogc3RyaW5nLCBub3c/OiBWVGltZXN0YW1wKTogVlRpbWVzdGFtcCB8IG51bGwge1xyXG4gIC8vIFlZWVktTU0tREQgaGg6bW06c3NcclxuICBjb25zdCBwYXJ0cyA9IFBBUlNFX1JFR0VYLmV4ZWMoaW5wdXQpXHJcblxyXG4gIGlmICghcGFydHMpIHJldHVybiBudWxsXHJcblxyXG4gIGNvbnN0IHRpbWVzdGFtcDogVlRpbWVzdGFtcCA9IHtcclxuICAgIGRhdGU6IGlucHV0LFxyXG4gICAgdGltZTogJycsXHJcbiAgICB5ZWFyOiBwYXJzZUludChwYXJ0c1sxXSksXHJcbiAgICBtb250aDogcGFyc2VJbnQocGFydHNbMl0pLFxyXG4gICAgZGF5OiBwYXJzZUludChwYXJ0c1s0XSkgfHwgMSxcclxuICAgIGhvdXI6IHBhcnNlSW50KHBhcnRzWzZdKSB8fCAwLFxyXG4gICAgbWludXRlOiBwYXJzZUludChwYXJ0c1s4XSkgfHwgMCxcclxuICAgIHdlZWtkYXk6IDAsXHJcbiAgICBoYXNEYXk6ICEhcGFydHNbNF0sXHJcbiAgICBoYXNUaW1lOiAhIShwYXJ0c1s2XSAmJiBwYXJ0c1s4XSksXHJcbiAgICBwYXN0OiBmYWxzZSxcclxuICAgIHByZXNlbnQ6IGZhbHNlLFxyXG4gICAgZnV0dXJlOiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgdXBkYXRlV2Vla2RheSh0aW1lc3RhbXApXHJcbiAgdXBkYXRlRm9ybWF0dGVkKHRpbWVzdGFtcClcclxuXHJcbiAgaWYgKG5vdykge1xyXG4gICAgdXBkYXRlUmVsYXRpdmUodGltZXN0YW1wLCBub3csIHRpbWVzdGFtcC5oYXNUaW1lKVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRpbWVzdGFtcFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VEYXRlIChkYXRlOiBEYXRlKTogVlRpbWVzdGFtcCB7XHJcbiAgcmV0dXJuIHVwZGF0ZUZvcm1hdHRlZCh7XHJcbiAgICBkYXRlOiAnJyxcclxuICAgIHRpbWU6ICcnLFxyXG4gICAgeWVhcjogZGF0ZS5nZXRGdWxsWWVhcigpLFxyXG4gICAgbW9udGg6IGRhdGUuZ2V0TW9udGgoKSArIDEsXHJcbiAgICBkYXk6IGRhdGUuZ2V0RGF0ZSgpLFxyXG4gICAgd2Vla2RheTogZGF0ZS5nZXREYXkoKSxcclxuICAgIGhvdXI6IGRhdGUuZ2V0SG91cnMoKSxcclxuICAgIG1pbnV0ZTogZGF0ZS5nZXRNaW51dGVzKCksXHJcbiAgICBoYXNEYXk6IHRydWUsXHJcbiAgICBoYXNUaW1lOiB0cnVlLFxyXG4gICAgcGFzdDogZmFsc2UsXHJcbiAgICBwcmVzZW50OiB0cnVlLFxyXG4gICAgZnV0dXJlOiBmYWxzZVxyXG4gIH0pXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREYXlJZGVudGlmaWVyICh0aW1lc3RhbXA6IFZUaW1lc3RhbXApOiBudW1iZXIge1xyXG4gIHJldHVybiB0aW1lc3RhbXAueWVhciAqIDEwMDAwICsgdGltZXN0YW1wLm1vbnRoICogMTAwICsgdGltZXN0YW1wLmRheVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGltZUlkZW50aWZpZXIgKHRpbWVzdGFtcDogVlRpbWVzdGFtcCk6IG51bWJlciB7XHJcbiAgcmV0dXJuIHRpbWVzdGFtcC5ob3VyICogMTAwICsgdGltZXN0YW1wLm1pbnV0ZVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlUmVsYXRpdmUgKHRpbWVzdGFtcDogVlRpbWVzdGFtcCwgbm93OiBWVGltZXN0YW1wLCB0aW1lID0gZmFsc2UpOiBWVGltZXN0YW1wIHtcclxuICBsZXQgYSA9IGdldERheUlkZW50aWZpZXIobm93KVxyXG4gIGxldCBiID0gZ2V0RGF5SWRlbnRpZmllcih0aW1lc3RhbXApXHJcbiAgbGV0IHByZXNlbnQgPSBhID09PSBiXHJcblxyXG4gIGlmICh0aW1lc3RhbXAuaGFzVGltZSAmJiB0aW1lICYmIHByZXNlbnQpIHtcclxuICAgIGEgPSBnZXRUaW1lSWRlbnRpZmllcihub3cpXHJcbiAgICBiID0gZ2V0VGltZUlkZW50aWZpZXIodGltZXN0YW1wKVxyXG4gICAgcHJlc2VudCA9IGEgPT09IGJcclxuICB9XHJcblxyXG4gIHRpbWVzdGFtcC5wYXN0ID0gYiA8IGFcclxuICB0aW1lc3RhbXAucHJlc2VudCA9IHByZXNlbnRcclxuICB0aW1lc3RhbXAuZnV0dXJlID0gYiA+IGFcclxuXHJcbiAgcmV0dXJuIHRpbWVzdGFtcFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlTWludXRlcyAodGltZXN0YW1wOiBWVGltZXN0YW1wLCBtaW51dGVzOiBudW1iZXIsIG5vdz86IFZUaW1lc3RhbXApOiBWVGltZXN0YW1wIHtcclxuICB0aW1lc3RhbXAuaGFzVGltZSA9IHRydWVcclxuICB0aW1lc3RhbXAuaG91ciA9IE1hdGguZmxvb3IobWludXRlcyAvIE1JTlVURVNfSU5fSE9VUilcclxuICB0aW1lc3RhbXAubWludXRlID0gbWludXRlcyAlIE1JTlVURVNfSU5fSE9VUlxyXG4gIHRpbWVzdGFtcC50aW1lID0gZ2V0VGltZSh0aW1lc3RhbXApXHJcbiAgaWYgKG5vdykge1xyXG4gICAgdXBkYXRlUmVsYXRpdmUodGltZXN0YW1wLCBub3csIHRydWUpXHJcbiAgfVxyXG5cclxuICByZXR1cm4gdGltZXN0YW1wXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVXZWVrZGF5ICh0aW1lc3RhbXA6IFZUaW1lc3RhbXApOiBWVGltZXN0YW1wIHtcclxuICB0aW1lc3RhbXAud2Vla2RheSA9IGdldFdlZWtkYXkodGltZXN0YW1wKVxyXG5cclxuICByZXR1cm4gdGltZXN0YW1wXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVGb3JtYXR0ZWQgKHRpbWVzdGFtcDogVlRpbWVzdGFtcCk6IFZUaW1lc3RhbXAge1xyXG4gIHRpbWVzdGFtcC50aW1lID0gZ2V0VGltZSh0aW1lc3RhbXApXHJcbiAgdGltZXN0YW1wLmRhdGUgPSBnZXREYXRlKHRpbWVzdGFtcClcclxuXHJcbiAgcmV0dXJuIHRpbWVzdGFtcFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2Vla2RheSAodGltZXN0YW1wOiBWVGltZXN0YW1wKTogbnVtYmVyIHtcclxuICBpZiAodGltZXN0YW1wLmhhc0RheSkge1xyXG4gICAgY29uc3QgXyA9IE1hdGguZmxvb3JcclxuICAgIGNvbnN0IGsgPSB0aW1lc3RhbXAuZGF5XHJcbiAgICBjb25zdCBtID0gKCh0aW1lc3RhbXAubW9udGggKyA5KSAlIE1PTlRIX01BWCkgKyAxXHJcbiAgICBjb25zdCBDID0gXyh0aW1lc3RhbXAueWVhciAvIDEwMClcclxuICAgIGNvbnN0IFkgPSAodGltZXN0YW1wLnllYXIgJSAxMDApIC0gKHRpbWVzdGFtcC5tb250aCA8PSAyID8gMSA6IDApXHJcblxyXG4gICAgcmV0dXJuICgoKGsgKyBfKDIuNiAqIG0gLSAwLjIpIC0gMiAqIEMgKyBZICsgXyhZIC8gNCkgKyBfKEMgLyA0KSkgJSA3KSArIDcpICUgN1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRpbWVzdGFtcC53ZWVrZGF5XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0xlYXBZZWFyICh5ZWFyOiBudW1iZXIpOiBib29sZWFuIHtcclxuICByZXR1cm4gKCh5ZWFyICUgNCA9PT0gMCkgJiYgKHllYXIgJSAxMDAgIT09IDApKSB8fCAoeWVhciAlIDQwMCA9PT0gMClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRheXNJbk1vbnRoICh5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXIpIHtcclxuICByZXR1cm4gaXNMZWFwWWVhcih5ZWFyKSA/IERBWVNfSU5fTU9OVEhfTEVBUFttb250aF0gOiBEQVlTX0lOX01PTlRIW21vbnRoXVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29weVRpbWVzdGFtcCAodGltZXN0YW1wOiBWVGltZXN0YW1wKTogVlRpbWVzdGFtcCB7XHJcbiAgY29uc3QgeyBkYXRlLCB0aW1lLCB5ZWFyLCBtb250aCwgZGF5LCB3ZWVrZGF5LCBob3VyLCBtaW51dGUsIGhhc0RheSwgaGFzVGltZSwgcGFzdCwgcHJlc2VudCwgZnV0dXJlIH0gPSB0aW1lc3RhbXBcclxuXHJcbiAgcmV0dXJuIHsgZGF0ZSwgdGltZSwgeWVhciwgbW9udGgsIGRheSwgd2Vla2RheSwgaG91ciwgbWludXRlLCBoYXNEYXksIGhhc1RpbWUsIHBhc3QsIHByZXNlbnQsIGZ1dHVyZSB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYWROdW1iZXIgKHg6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gIGxldCBwYWRkZWQgPSBTdHJpbmcoeClcclxuICB3aGlsZSAocGFkZGVkLmxlbmd0aCA8IGxlbmd0aCkge1xyXG4gICAgcGFkZGVkID0gJzAnICsgcGFkZGVkXHJcbiAgfVxyXG5cclxuICByZXR1cm4gcGFkZGVkXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRlICh0aW1lc3RhbXA6IFZUaW1lc3RhbXApOiBzdHJpbmcge1xyXG4gIGxldCBzdHIgPSBgJHtwYWROdW1iZXIodGltZXN0YW1wLnllYXIsIDQpfS0ke3BhZE51bWJlcih0aW1lc3RhbXAubW9udGgsIDIpfWBcclxuXHJcbiAgaWYgKHRpbWVzdGFtcC5oYXNEYXkpIHN0ciArPSBgLSR7cGFkTnVtYmVyKHRpbWVzdGFtcC5kYXksIDIpfWBcclxuXHJcbiAgcmV0dXJuIHN0clxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGltZSAodGltZXN0YW1wOiBWVGltZXN0YW1wKTogc3RyaW5nIHtcclxuICBpZiAoIXRpbWVzdGFtcC5oYXNUaW1lKSB7XHJcbiAgICByZXR1cm4gJydcclxuICB9XHJcblxyXG4gIHJldHVybiBgJHtwYWROdW1iZXIodGltZXN0YW1wLmhvdXIsIDIpfToke3BhZE51bWJlcih0aW1lc3RhbXAubWludXRlLCAyKX1gXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBuZXh0TWludXRlcyAodGltZXN0YW1wOiBWVGltZXN0YW1wLCBtaW51dGVzOiBudW1iZXIpOiBWVGltZXN0YW1wIHtcclxuICB0aW1lc3RhbXAubWludXRlICs9IG1pbnV0ZXNcclxuICB3aGlsZSAodGltZXN0YW1wLm1pbnV0ZSA+IE1JTlVURVNfSU5fSE9VUikge1xyXG4gICAgdGltZXN0YW1wLm1pbnV0ZSAtPSBNSU5VVEVTX0lOX0hPVVJcclxuICAgIHRpbWVzdGFtcC5ob3VyKytcclxuICAgIGlmICh0aW1lc3RhbXAuaG91ciA+PSBIT1VSU19JTl9EQVkpIHtcclxuICAgICAgbmV4dERheSh0aW1lc3RhbXApXHJcbiAgICAgIHRpbWVzdGFtcC5ob3VyID0gRklSU1RfSE9VUlxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRpbWVzdGFtcFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbmV4dERheSAodGltZXN0YW1wOiBWVGltZXN0YW1wKTogVlRpbWVzdGFtcCB7XHJcbiAgdGltZXN0YW1wLmRheSsrXHJcbiAgdGltZXN0YW1wLndlZWtkYXkgPSAodGltZXN0YW1wLndlZWtkYXkgKyAxKSAlIERBWVNfSU5fV0VFS1xyXG4gIGlmICh0aW1lc3RhbXAuZGF5ID4gREFZU19JTl9NT05USF9NSU4gJiYgdGltZXN0YW1wLmRheSA+IGRheXNJbk1vbnRoKHRpbWVzdGFtcC55ZWFyLCB0aW1lc3RhbXAubW9udGgpKSB7XHJcbiAgICB0aW1lc3RhbXAuZGF5ID0gREFZX01JTlxyXG4gICAgdGltZXN0YW1wLm1vbnRoKytcclxuICAgIGlmICh0aW1lc3RhbXAubW9udGggPiBNT05USF9NQVgpIHtcclxuICAgICAgdGltZXN0YW1wLm1vbnRoID0gTU9OVEhfTUlOXHJcbiAgICAgIHRpbWVzdGFtcC55ZWFyKytcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB0aW1lc3RhbXBcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHByZXZEYXkgKHRpbWVzdGFtcDogVlRpbWVzdGFtcCk6IFZUaW1lc3RhbXAge1xyXG4gIHRpbWVzdGFtcC5kYXktLVxyXG4gIHRpbWVzdGFtcC53ZWVrZGF5ID0gKHRpbWVzdGFtcC53ZWVrZGF5ICsgNikgJSBEQVlTX0lOX1dFRUtcclxuICBpZiAodGltZXN0YW1wLmRheSA8IERBWV9NSU4pIHtcclxuICAgIHRpbWVzdGFtcC5tb250aC0tXHJcbiAgICBpZiAodGltZXN0YW1wLm1vbnRoIDwgTU9OVEhfTUlOKSB7XHJcbiAgICAgIHRpbWVzdGFtcC55ZWFyLS1cclxuICAgICAgdGltZXN0YW1wLm1vbnRoID0gTU9OVEhfTUFYXHJcbiAgICB9XHJcbiAgICB0aW1lc3RhbXAuZGF5ID0gZGF5c0luTW9udGgodGltZXN0YW1wLnllYXIsIHRpbWVzdGFtcC5tb250aClcclxuICB9XHJcblxyXG4gIHJldHVybiB0aW1lc3RhbXBcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbGF0aXZlRGF5cyAodGltZXN0YW1wOiBWVGltZXN0YW1wLFxyXG4gIG1vdmVyOiBWVGltZXN0YW1wT3BlcmF0aW9uID0gbmV4dERheSwgZGF5cyA9IDEpOiBWVGltZXN0YW1wIHtcclxuICB3aGlsZSAoLS1kYXlzID49IDApIG1vdmVyKHRpbWVzdGFtcClcclxuXHJcbiAgcmV0dXJuIHRpbWVzdGFtcFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmluZFdlZWtkYXkgKHRpbWVzdGFtcDogVlRpbWVzdGFtcCwgd2Vla2RheTogbnVtYmVyLFxyXG4gIG1vdmVyOiBWVGltZXN0YW1wT3BlcmF0aW9uID0gbmV4dERheSwgbWF4RGF5cyA9IDYpOiBWVGltZXN0YW1wIHtcclxuICB3aGlsZSAodGltZXN0YW1wLndlZWtkYXkgIT09IHdlZWtkYXkgJiYgLS1tYXhEYXlzID49IDApIG1vdmVyKHRpbWVzdGFtcClcclxuXHJcbiAgcmV0dXJuIHRpbWVzdGFtcFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2Vla2RheVNraXBzICh3ZWVrZGF5czogbnVtYmVyW10pOiBudW1iZXJbXSB7XHJcbiAgY29uc3Qgc2tpcHM6IG51bWJlcltdID0gWzEsIDEsIDEsIDEsIDEsIDEsIDFdXHJcbiAgY29uc3QgZmlsbGVkOiBudW1iZXJbXSA9IFswLCAwLCAwLCAwLCAwLCAwLCAwXVxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgd2Vla2RheXMubGVuZ3RoOyBpKyspIHtcclxuICAgIGZpbGxlZFt3ZWVrZGF5c1tpXV0gPSAxXHJcbiAgfVxyXG4gIGZvciAobGV0IGsgPSAwOyBrIDwgREFZU19JTl9XRUVLOyBrKyspIHtcclxuICAgIGxldCBza2lwID0gMVxyXG4gICAgZm9yIChsZXQgaiA9IDE7IGogPCBEQVlTX0lOX1dFRUs7IGorKykge1xyXG4gICAgICBjb25zdCBuZXh0ID0gKGsgKyBqKSAlIERBWVNfSU5fV0VFS1xyXG4gICAgICBpZiAoZmlsbGVkW25leHRdKSB7XHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgfVxyXG4gICAgICBza2lwKytcclxuICAgIH1cclxuICAgIHNraXBzW2tdID0gZmlsbGVkW2tdICogc2tpcFxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHNraXBzXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVEYXlMaXN0IChzdGFydDogVlRpbWVzdGFtcCwgZW5kOiBWVGltZXN0YW1wLCBub3c6IFZUaW1lc3RhbXAsXHJcbiAgd2Vla2RheVNraXBzOiBudW1iZXJbXSwgbWF4ID0gNDIsIG1pbiA9IDApOiBWVGltZXN0YW1wW10ge1xyXG4gIGNvbnN0IHN0b3AgPSBnZXREYXlJZGVudGlmaWVyKGVuZClcclxuICBjb25zdCBkYXlzOiBWVGltZXN0YW1wW10gPSBbXVxyXG4gIGxldCBjdXJyZW50ID0gY29weVRpbWVzdGFtcChzdGFydClcclxuICBsZXQgY3VycmVudElkZW50aWZpZXIgPSAwXHJcbiAgbGV0IHN0b3BwZWQgPSBjdXJyZW50SWRlbnRpZmllciA9PT0gc3RvcFxyXG5cclxuICBpZiAoc3RvcCA8IGdldERheUlkZW50aWZpZXIoc3RhcnQpKSB7XHJcbiAgICByZXR1cm4gZGF5c1xyXG4gIH1cclxuXHJcbiAgd2hpbGUgKCghc3RvcHBlZCB8fCBkYXlzLmxlbmd0aCA8IG1pbikgJiYgZGF5cy5sZW5ndGggPCBtYXgpIHtcclxuICAgIGN1cnJlbnRJZGVudGlmaWVyID0gZ2V0RGF5SWRlbnRpZmllcihjdXJyZW50KVxyXG4gICAgc3RvcHBlZCA9IHN0b3BwZWQgfHwgY3VycmVudElkZW50aWZpZXIgPT09IHN0b3BcclxuICAgIGlmICh3ZWVrZGF5U2tpcHNbY3VycmVudC53ZWVrZGF5XSA9PT0gMCkge1xyXG4gICAgICBjdXJyZW50ID0gbmV4dERheShjdXJyZW50KVxyXG4gICAgICBjb250aW51ZVxyXG4gICAgfVxyXG4gICAgY29uc3QgZGF5ID0gY29weVRpbWVzdGFtcChjdXJyZW50KVxyXG4gICAgdXBkYXRlRm9ybWF0dGVkKGRheSlcclxuICAgIHVwZGF0ZVJlbGF0aXZlKGRheSwgbm93KVxyXG4gICAgZGF5cy5wdXNoKGRheSlcclxuICAgIGN1cnJlbnQgPSByZWxhdGl2ZURheXMoY3VycmVudCwgbmV4dERheSwgd2Vla2RheVNraXBzW2N1cnJlbnQud2Vla2RheV0pXHJcbiAgfVxyXG5cclxuICByZXR1cm4gZGF5c1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlSW50ZXJ2YWxMaXN0ICh0aW1lc3RhbXA6IFZUaW1lc3RhbXAsIGZpcnN0OiBudW1iZXIsXHJcbiAgbWludXRlczogbnVtYmVyLCBjb3VudDogbnVtYmVyLCBub3c/OiBWVGltZXN0YW1wKTogVlRpbWVzdGFtcFtdIHtcclxuICBjb25zdCBpbnRlcnZhbHM6IFZUaW1lc3RhbXBbXSA9IFtdXHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xyXG4gICAgY29uc3QgbWlucyA9IChmaXJzdCArIGkpICogbWludXRlc1xyXG4gICAgY29uc3QgaW50ID0gY29weVRpbWVzdGFtcCh0aW1lc3RhbXApXHJcbiAgICBpbnRlcnZhbHMucHVzaCh1cGRhdGVNaW51dGVzKGludCwgbWlucywgbm93KSlcclxuICB9XHJcblxyXG4gIHJldHVybiBpbnRlcnZhbHNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU5hdGl2ZUxvY2FsZUZvcm1hdHRlciAobG9jYWxlOiBzdHJpbmcsIGdldE9wdGlvbnM6IFZUaW1lc3RhbXBGb3JtYXRPcHRpb25zKTogVlRpbWVzdGFtcEZvcm1hdHRlciB7XHJcbiAgY29uc3QgZW1wdHlGb3JtYXR0ZXI6IFZUaW1lc3RhbXBGb3JtYXR0ZXIgPSAoX3QsIF9zKSA9PiAnJ1xyXG5cclxuICBpZiAodHlwZW9mIEludGwgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBJbnRsLkRhdGVUaW1lRm9ybWF0ID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgcmV0dXJuIGVtcHR5Rm9ybWF0dGVyXHJcbiAgfVxyXG5cclxuICByZXR1cm4gKHRpbWVzdGFtcCwgc2hvcnQpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGludGxGb3JtYXR0ZXIgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChsb2NhbGUgfHwgdW5kZWZpbmVkLCBnZXRPcHRpb25zKHRpbWVzdGFtcCwgc2hvcnQpKVxyXG4gICAgICBjb25zdCB0aW1lID0gYCR7cGFkTnVtYmVyKHRpbWVzdGFtcC5ob3VyLCAyKX06JHtwYWROdW1iZXIodGltZXN0YW1wLm1pbnV0ZSwgMil9YFxyXG4gICAgICBjb25zdCBkYXRlID0gdGltZXN0YW1wLmRhdGVcclxuICAgICAgcmV0dXJuIGludGxGb3JtYXR0ZXIuZm9ybWF0KG5ldyBEYXRlKGAke2RhdGV9VCR7dGltZX06MDArMDA6MDBgKSlcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgcmV0dXJuICcnXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==