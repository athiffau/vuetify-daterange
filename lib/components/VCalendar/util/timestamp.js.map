{"version":3,"sources":["../../../../src/components/VCalendar/util/timestamp.ts"],"names":[],"mappings":"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","sourcesContent":["\r\nexport const PARSE_REGEX: RegExp = /^(\\d{1,4})-(\\d{1,2})(-(\\d{1,2}))?([^\\d]+(\\d{1,2}))?(:(\\d{1,2}))?(:(\\d{1,2}))?$/\r\nexport const PARSE_TIME: RegExp = /(\\d{1,2})?(:(\\d{1,2}))?(:(\\d{1,2}))/\r\n\r\nexport const DAYS_IN_MONTH: number[] = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\r\nexport const DAYS_IN_MONTH_LEAP: number[] = [0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\r\nexport const DAYS_IN_MONTH_MIN = 28\r\nexport const DAYS_IN_MONTH_MAX = 31\r\nexport const MONTH_MAX = 12\r\nexport const MONTH_MIN = 1\r\nexport const DAY_MIN = 1\r\nexport const DAYS_IN_WEEK = 7\r\nexport const MINUTES_IN_HOUR = 60\r\nexport const HOURS_IN_DAY = 24\r\nexport const FIRST_HOUR = 0\r\n\r\nexport interface VTimestamp {\r\n  date: string\r\n  time: string\r\n  year: number\r\n  month: number\r\n  day: number\r\n  weekday: number\r\n  hour: number\r\n  minute: number\r\n  hasDay: boolean\r\n  hasTime: boolean\r\n  past: boolean\r\n  present: boolean\r\n  future: boolean\r\n}\r\n\r\nexport interface VTimeObject {\r\n  hour: number\r\n  minute: number\r\n}\r\n\r\nexport type VTime = number | string | VTimeObject\r\n\r\nexport type VTimestampFormatter = (timestamp: VTimestamp, short: boolean) => string\r\n\r\nexport type VTimestampFormatOptions = (timestamp: VTimestamp, short: boolean) => object\r\n\r\nexport type VTimestampOperation = (timestamp: VTimestamp) => VTimestamp\r\n\r\nexport function parseTime (input: any): number | false {\r\n  if (typeof input === 'number') {\r\n    // when a number is given, it's minutes since 12:00am\r\n    return input\r\n  } else if (typeof input === 'string') {\r\n    // when a string is given, it's a hh:mm:ss format where seconds are optional\r\n    const parts = PARSE_TIME.exec(input)\r\n    if (!parts) {\r\n      return false\r\n    }\r\n    return parseInt(parts[1]) * 60 + parseInt(parts[2] || 0)\r\n  } else if (typeof input === 'object') {\r\n    // when an object is given, it must have hour and minute\r\n    if (typeof input.hour !== 'number' || typeof input.minute !== 'number') {\r\n      return false\r\n    }\r\n    return input.hour * 60 + input.minute\r\n  } else {\r\n    // unsupported type\r\n    return false\r\n  }\r\n}\r\n\r\nexport function validateTimestamp (input: any): boolean {\r\n  return !!PARSE_REGEX.exec(input)\r\n}\r\n\r\nexport function parseTimestamp (input: string, now?: VTimestamp): VTimestamp | null {\r\n  // YYYY-MM-DD hh:mm:ss\r\n  const parts = PARSE_REGEX.exec(input)\r\n\r\n  if (!parts) return null\r\n\r\n  const timestamp: VTimestamp = {\r\n    date: input,\r\n    time: '',\r\n    year: parseInt(parts[1]),\r\n    month: parseInt(parts[2]),\r\n    day: parseInt(parts[4]) || 1,\r\n    hour: parseInt(parts[6]) || 0,\r\n    minute: parseInt(parts[8]) || 0,\r\n    weekday: 0,\r\n    hasDay: !!parts[4],\r\n    hasTime: !!(parts[6] && parts[8]),\r\n    past: false,\r\n    present: false,\r\n    future: false\r\n  }\r\n\r\n  updateWeekday(timestamp)\r\n  updateFormatted(timestamp)\r\n\r\n  if (now) {\r\n    updateRelative(timestamp, now, timestamp.hasTime)\r\n  }\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function parseDate (date: Date): VTimestamp {\r\n  return updateFormatted({\r\n    date: '',\r\n    time: '',\r\n    year: date.getFullYear(),\r\n    month: date.getMonth() + 1,\r\n    day: date.getDate(),\r\n    weekday: date.getDay(),\r\n    hour: date.getHours(),\r\n    minute: date.getMinutes(),\r\n    hasDay: true,\r\n    hasTime: true,\r\n    past: false,\r\n    present: true,\r\n    future: false\r\n  })\r\n}\r\n\r\nexport function getDayIdentifier (timestamp: VTimestamp): number {\r\n  return timestamp.year * 1000000 + timestamp.month * 100 + timestamp.day\r\n}\r\n\r\nexport function getTimeIdentifier (timestamp: VTimestamp): number {\r\n  return timestamp.hour * 100 + timestamp.minute\r\n}\r\n\r\nexport function updateRelative (timestamp: VTimestamp, now: VTimestamp, time = false): VTimestamp {\r\n  let a = getDayIdentifier(now)\r\n  let b = getDayIdentifier(timestamp)\r\n  let present = a === b\r\n\r\n  if (timestamp.hasTime && time && present) {\r\n    a = getTimeIdentifier(now)\r\n    b = getTimeIdentifier(timestamp)\r\n    present = a === b\r\n  }\r\n\r\n  timestamp.past = b < a\r\n  timestamp.present = present\r\n  timestamp.future = b > a\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function updateMinutes (timestamp: VTimestamp, minutes: number, now?: VTimestamp): VTimestamp {\r\n  timestamp.hasTime = true\r\n  timestamp.hour = Math.floor(minutes / MINUTES_IN_HOUR)\r\n  timestamp.minute = minutes % MINUTES_IN_HOUR\r\n  timestamp.time = getTime(timestamp)\r\n  if (now) {\r\n    updateRelative(timestamp, now, true)\r\n  }\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function updateWeekday (timestamp: VTimestamp): VTimestamp {\r\n  timestamp.weekday = getWeekday(timestamp)\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function updateFormatted (timestamp: VTimestamp): VTimestamp {\r\n  timestamp.time = getTime(timestamp)\r\n  timestamp.date = getDate(timestamp)\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function getWeekday (timestamp: VTimestamp): number {\r\n  if (timestamp.hasDay) {\r\n    const _ = Math.floor\r\n    const k = timestamp.day\r\n    const m = ((timestamp.month + 9) % MONTH_MAX) + 1\r\n    const C = _(timestamp.year / 100)\r\n    const Y = (timestamp.year % 100) - (timestamp.month <= 2 ? 1 : 0)\r\n\r\n    return (k + _(2.6 * m - 0.2) - 2 * C + Y + _(Y / 4) + _(C / 4)) % 7\r\n  }\r\n\r\n  return timestamp.weekday\r\n}\r\n\r\nexport function isLeapYear (year: number): boolean {\r\n  return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0)\r\n}\r\n\r\nexport function daysInMonth (year: number, month: number) {\r\n  return isLeapYear(year) ? DAYS_IN_MONTH_LEAP[month] : DAYS_IN_MONTH[month]\r\n}\r\n\r\nexport function copyTimestamp (timestamp: VTimestamp): VTimestamp {\r\n  const { date, time, year, month, day, weekday, hour, minute, hasDay, hasTime, past, present, future } = timestamp\r\n\r\n  return { date, time, year, month, day, weekday, hour, minute, hasDay, hasTime, past, present, future }\r\n}\r\n\r\nexport function padNumber (x: number, length: number): string {\r\n  let padded = String(x)\r\n  while (padded.length < length) {\r\n    padded = '0' + padded\r\n  }\r\n\r\n  return padded\r\n}\r\n\r\nexport function getDate (timestamp: VTimestamp): string {\r\n  let str = `${padNumber(timestamp.year, 4)}-${padNumber(timestamp.month, 2)}`\r\n\r\n  if (timestamp.hasDay) str += `-${padNumber(timestamp.day, 2)}`\r\n\r\n  return str\r\n}\r\n\r\nexport function getTime (timestamp: VTimestamp): string {\r\n  if (!timestamp.hasTime) {\r\n    return ''\r\n  }\r\n\r\n  return `${padNumber(timestamp.hour, 2)}:${padNumber(timestamp.minute, 2)}`\r\n}\r\n\r\nexport function nextMinutes (timestamp: VTimestamp, minutes: number): VTimestamp {\r\n  timestamp.minute += minutes\r\n  while (timestamp.minute > MINUTES_IN_HOUR) {\r\n    timestamp.minute -= MINUTES_IN_HOUR\r\n    timestamp.hour++\r\n    if (timestamp.hour >= HOURS_IN_DAY) {\r\n      nextDay(timestamp)\r\n      timestamp.hour = FIRST_HOUR\r\n    }\r\n  }\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function nextDay (timestamp: VTimestamp): VTimestamp {\r\n  timestamp.day++\r\n  timestamp.weekday = (timestamp.weekday + 1) % DAYS_IN_WEEK\r\n  if (timestamp.day > DAYS_IN_MONTH_MIN && timestamp.day > daysInMonth(timestamp.year, timestamp.month)) {\r\n    timestamp.day = DAY_MIN\r\n    timestamp.month++\r\n    if (timestamp.month > MONTH_MAX) {\r\n      timestamp.month = MONTH_MIN\r\n      timestamp.year++\r\n    }\r\n  }\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function prevDay (timestamp: VTimestamp): VTimestamp {\r\n  timestamp.day--\r\n  timestamp.weekday = (timestamp.weekday + 6) % DAYS_IN_WEEK\r\n  if (timestamp.day < DAY_MIN) {\r\n    timestamp.month--\r\n    if (timestamp.month < MONTH_MIN) {\r\n      timestamp.year--\r\n      timestamp.month = MONTH_MAX\r\n    }\r\n    timestamp.day = daysInMonth(timestamp.year, timestamp.month)\r\n  }\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function relativeDays (timestamp: VTimestamp,\r\n  mover: VTimestampOperation = nextDay, days = 1): VTimestamp {\r\n  while (--days >= 0) mover(timestamp)\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function findWeekday (timestamp: VTimestamp, weekday: number,\r\n  mover: VTimestampOperation = nextDay, maxDays = 6): VTimestamp {\r\n  while (timestamp.weekday !== weekday && --maxDays >= 0) mover(timestamp)\r\n\r\n  return timestamp\r\n}\r\n\r\nexport function getWeekdaySkips (weekdays: number[]): number[] {\r\n  const skips: number[] = [1, 1, 1, 1, 1, 1, 1]\r\n  const filled: number[] = [0, 0, 0, 0, 0, 0, 0]\r\n  for (let i = 0; i < weekdays.length; i++) {\r\n    filled[weekdays[i]] = 1\r\n  }\r\n  for (let k = 0; k < DAYS_IN_WEEK; k++) {\r\n    let skip = 1\r\n    for (let j = 1; j < DAYS_IN_WEEK; j++) {\r\n      const next = (k + j) % DAYS_IN_WEEK\r\n      if (filled[next]) {\r\n        break\r\n      }\r\n      skip++\r\n    }\r\n    skips[k] = filled[k] * skip\r\n  }\r\n\r\n  return skips\r\n}\r\n\r\nexport function createDayList (start: VTimestamp, end: VTimestamp, now: VTimestamp,\r\n  weekdaySkips: number[], max = 42, min = 0): VTimestamp[] {\r\n  const stop = getDayIdentifier(end)\r\n  const days: VTimestamp[] = []\r\n  let current = copyTimestamp(start)\r\n  let currentIdentifier = 0\r\n  let stopped = currentIdentifier === stop\r\n\r\n  if (stop < getDayIdentifier(start)) {\r\n    return days\r\n  }\r\n\r\n  while ((!stopped || days.length < min) && days.length < max) {\r\n    currentIdentifier = getDayIdentifier(current)\r\n    stopped = stopped || currentIdentifier === stop\r\n    if (weekdaySkips[current.weekday] === 0) {\r\n      current = nextDay(current)\r\n      continue\r\n    }\r\n    const day = copyTimestamp(current)\r\n    updateFormatted(day)\r\n    updateRelative(day, now)\r\n    days.push(day)\r\n    current = relativeDays(current, nextDay, weekdaySkips[current.weekday])\r\n  }\r\n\r\n  return days\r\n}\r\n\r\nexport function createIntervalList (timestamp: VTimestamp, first: number,\r\n  minutes: number, count: number, now?: VTimestamp): VTimestamp[] {\r\n  const intervals: VTimestamp[] = []\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const mins = (first + i) * minutes\r\n    const int = copyTimestamp(timestamp)\r\n    intervals.push(updateMinutes(int, mins, now))\r\n  }\r\n\r\n  return intervals\r\n}\r\n\r\nexport function createNativeLocaleFormatter (locale: string, getOptions: VTimestampFormatOptions): VTimestampFormatter {\r\n  const emptyFormatter: VTimestampFormatter = (_t, _s) => ''\r\n\r\n  if (typeof Intl === 'undefined' || typeof Intl.DateTimeFormat === 'undefined') {\r\n    return emptyFormatter\r\n  }\r\n\r\n  return (timestamp, short) => {\r\n    try {\r\n      const intlFormatter = new Intl.DateTimeFormat(locale || undefined, getOptions(timestamp, short))\r\n      const time = `${padNumber(timestamp.hour, 2)}:${padNumber(timestamp.minute, 2)}`\r\n      const date = timestamp.date\r\n      return intlFormatter.format(new Date(`${date}T${time}:00+00:00`))\r\n    } catch (e) {\r\n      return ''\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":""}