{"version":3,"sources":["../../../../src/components/VCalendar/mixins/calendar-with-intervals.ts"],"names":[],"mappings":"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","sourcesContent":["\r\n// Mixins\r\nimport CalendarBase from './calendar-base'\r\n\r\n// Util\r\nimport props from '../util/props'\r\nimport {\r\n  VTimestamp,\r\n  VTime,\r\n  VTimestampFormatter,\r\n  parseTime,\r\n  copyTimestamp,\r\n  updateMinutes,\r\n  createDayList,\r\n  createIntervalList,\r\n  createNativeLocaleFormatter\r\n} from '../util/timestamp'\r\n\r\n/* @vue/component */\r\nexport default CalendarBase.extend({\r\n  name: 'calendar-with-intervals',\r\n\r\n  props: props.intervals,\r\n\r\n  computed: {\r\n    parsedFirstInterval (): number {\r\n      return parseInt(this.firstInterval)\r\n    },\r\n    parsedIntervalMinutes (): number {\r\n      return parseInt(this.intervalMinutes)\r\n    },\r\n    parsedIntervalCount (): number {\r\n      return parseInt(this.intervalCount)\r\n    },\r\n    parsedIntervalHeight (): number {\r\n      return parseFloat(this.intervalHeight)\r\n    },\r\n    firstMinute (): number {\r\n      return this.parsedFirstInterval * this.parsedIntervalMinutes\r\n    },\r\n    bodyHeight (): number {\r\n      return this.parsedIntervalCount * this.parsedIntervalHeight\r\n    },\r\n    days (): VTimestamp[] {\r\n      return createDayList(\r\n        this.parsedStart,\r\n        this.parsedEnd,\r\n        this.times.today,\r\n        this.weekdaySkips,\r\n        this.maxDays\r\n      )\r\n    },\r\n    intervals (): VTimestamp[][] {\r\n      const days: VTimestamp[] = this.days\r\n      const first: number = this.parsedFirstInterval\r\n      const minutes: number = this.parsedIntervalMinutes\r\n      const count: number = this.parsedIntervalCount\r\n      const now: VTimestamp = this.times.now\r\n\r\n      return days.map(d => createIntervalList(d, first, minutes, count, now))\r\n    },\r\n    intervalFormatter (): VTimestampFormatter {\r\n      if (this.intervalFormat) {\r\n        return this.intervalFormat as VTimestampFormatter\r\n      }\r\n\r\n      const longOptions = { timeZone: 'UTC', hour12: true, hour: '2-digit', minute: '2-digit' }\r\n      const shortOptions = { timeZone: 'UTC', hour12: true, hour: 'numeric', minute: '2-digit' }\r\n      const shortHourOptions = { timeZone: 'UTC', hour12: true, hour: 'numeric' }\r\n\r\n      return createNativeLocaleFormatter(\r\n        this.locale,\r\n        (tms, short) => short ? (tms.minute === 0 ? shortHourOptions : shortOptions) : longOptions\r\n      )\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    showIntervalLabelDefault (interval: VTimestamp): boolean {\r\n      const first: VTimestamp = this.intervals[0][0]\r\n      const isFirst: boolean = first.hour === interval.hour && first.minute === interval.minute\r\n      return !isFirst && interval.minute === 0\r\n    },\r\n    intervalStyleDefault (_interval: VTimestamp): object | undefined {\r\n      return undefined\r\n    },\r\n    getTimestampAtEvent (e: MouseEvent | TouchEvent, day: VTimestamp): VTimestamp {\r\n      const timestamp: VTimestamp = copyTimestamp(day)\r\n      const bounds = (e.currentTarget as HTMLElement).getBoundingClientRect()\r\n      const baseMinutes: number = this.firstMinute\r\n      const touchEvent: TouchEvent = e as TouchEvent\r\n      const mouseEvent: MouseEvent = e as MouseEvent\r\n      const touches: TouchList = touchEvent.changedTouches || touchEvent.touches\r\n      const clientY: number = touches && touches[0] ? touches[0].clientY : mouseEvent.clientY\r\n      const addIntervals: number = (clientY - bounds.top) / this.parsedIntervalHeight\r\n      const addMinutes: number = Math.floor(addIntervals * this.parsedIntervalMinutes)\r\n      const minutes: number = baseMinutes + addMinutes\r\n\r\n      return updateMinutes(timestamp, minutes, this.times.now)\r\n    },\r\n    getSlotScope (timestamp: VTimestamp): any {\r\n      const scope = copyTimestamp(timestamp) as any\r\n      scope.timeToY = this.timeToY\r\n      scope.minutesToPixels = this.minutesToPixels\r\n      return scope\r\n    },\r\n    scrollToTime (time: VTime): boolean {\r\n      const y = this.timeToY(time)\r\n      const pane = this.$refs.scrollArea as HTMLElement\r\n\r\n      if (y === false || !pane) {\r\n        return false\r\n      }\r\n\r\n      pane.scrollTop = y\r\n\r\n      return true\r\n    },\r\n    minutesToPixels (minutes: number): number {\r\n      return minutes / this.parsedIntervalMinutes * this.parsedIntervalHeight\r\n    },\r\n    timeToY (time: VTime, clamp = true): number | false {\r\n      const minutes = parseTime(time)\r\n\r\n      if (minutes === false) {\r\n        return false\r\n      }\r\n\r\n      const min: number = this.firstMinute\r\n      const gap: number = this.parsedIntervalCount * this.parsedIntervalMinutes\r\n      const delta: number = (minutes - min) / gap\r\n      let y: number = delta * this.bodyHeight\r\n\r\n      if (clamp) {\r\n        if (y < 0) {\r\n          y = 0\r\n        }\r\n        if (y > this.bodyHeight) {\r\n          y = this.bodyHeight\r\n        }\r\n      }\r\n\r\n      return y\r\n    }\r\n  }\r\n})\r\n"],"sourceRoot":""}