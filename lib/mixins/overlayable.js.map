{"version":3,"sources":["../../src/mixins/overlayable.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\r\nimport '../stylus/components/_overlay.styl'\r\n\r\n// Utilities\r\nimport { keyCodes } from '../util/helpers'\r\n\r\n// Types\r\nimport Vue from 'vue'\r\n\r\ninterface Toggleable extends Vue {\r\n  isActive?: boolean\r\n}\r\n\r\ninterface Stackable extends Vue {\r\n  activeZIndex: number\r\n}\r\n\r\ninterface options {\r\n  absolute?: boolean\r\n  $refs: {\r\n    dialog?: HTMLElement\r\n    content?: HTMLElement\r\n  }\r\n}\r\n\r\n/* @vue/component */\r\nexport default Vue.extend<Vue & Toggleable & Stackable & options>().extend({\r\n  name: 'overlayable',\r\n\r\n  props: {\r\n    hideOverlay: Boolean\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      overlay: null as HTMLElement | null,\r\n      overlayOffset: 0,\r\n      overlayTimeout: undefined as number | undefined,\r\n      overlayTransitionDuration: 500 + 150 // transition + delay\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    hideOverlay (value) {\r\n      if (value) this.removeOverlay()\r\n      else this.genOverlay()\r\n    }\r\n  },\r\n\r\n  beforeDestroy () {\r\n    this.removeOverlay()\r\n  },\r\n\r\n  methods: {\r\n    genOverlay () {\r\n      // If fn is called and timeout is active\r\n      // or overlay already exists\r\n      // cancel removal of overlay and re-add active\r\n      if ((!this.isActive || this.hideOverlay) ||\r\n        (this.isActive && this.overlayTimeout) ||\r\n        this.overlay\r\n      ) {\r\n        clearTimeout(this.overlayTimeout)\r\n\r\n        return this.overlay &&\r\n          this.overlay.classList.add('v-overlay--active')\r\n      }\r\n\r\n      this.overlay = document.createElement('div')\r\n      this.overlay.className = 'v-overlay'\r\n\r\n      if (this.absolute) this.overlay.className += ' v-overlay--absolute'\r\n\r\n      this.hideScroll()\r\n\r\n      const parent = this.absolute\r\n        ? this.$el.parentNode\r\n        : document.querySelector('[data-app]')\r\n\r\n      parent && parent.insertBefore(this.overlay, parent.firstChild)\r\n\r\n      // eslint-disable-next-line no-unused-expressions\r\n      this.overlay.clientHeight // Force repaint\r\n      requestAnimationFrame(() => {\r\n        // https://github.com/vuetifyjs/vuetify/issues/4678\r\n        if (!this.overlay) return\r\n\r\n        this.overlay.className += ' v-overlay--active'\r\n\r\n        if (this.activeZIndex !== undefined) {\r\n          this.overlay.style.zIndex = String(this.activeZIndex - 1)\r\n        }\r\n      })\r\n\r\n      return true\r\n    },\r\n    /** removeOverlay(false) will not restore the scollbar afterwards */\r\n    removeOverlay (showScroll = true) {\r\n      if (!this.overlay) {\r\n        return showScroll && this.showScroll()\r\n      }\r\n\r\n      this.overlay.classList.remove('v-overlay--active')\r\n\r\n      this.overlayTimeout = window.setTimeout(() => {\r\n        // IE11 Fix\r\n        try {\r\n          if (this.overlay && this.overlay.parentNode) {\r\n            this.overlay.parentNode.removeChild(this.overlay)\r\n          }\r\n          this.overlay = null\r\n          showScroll && this.showScroll()\r\n        } catch (e) { console.log(e) }\r\n\r\n        clearTimeout(this.overlayTimeout)\r\n        this.overlayTimeout = undefined\r\n      }, this.overlayTransitionDuration)\r\n    },\r\n    scrollListener (e: WheelEvent & KeyboardEvent) {\r\n      if (e.type === 'keydown') {\r\n        if (\r\n          ['INPUT', 'TEXTAREA', 'SELECT'].includes((e.target as Element).tagName) ||\r\n          // https://github.com/vuetifyjs/vuetify/issues/4715\r\n          (e.target as HTMLElement).isContentEditable\r\n        ) return\r\n\r\n        const up = [keyCodes.up, keyCodes.pageup]\r\n        const down = [keyCodes.down, keyCodes.pagedown]\r\n\r\n        if (up.includes(e.keyCode)) {\r\n          (e as any).deltaY = -1\r\n        } else if (down.includes(e.keyCode)) {\r\n          (e as any).deltaY = 1\r\n        } else {\r\n          return\r\n        }\r\n      }\r\n\r\n      if (e.target === this.overlay ||\r\n        (e.type !== 'keydown' && e.target === document.body) ||\r\n        this.checkPath(e)) e.preventDefault()\r\n    },\r\n    hasScrollbar (el?: Element) {\r\n      if (!el || el.nodeType !== Node.ELEMENT_NODE) return false\r\n\r\n      const style = window.getComputedStyle(el)\r\n      return ['auto', 'scroll'].includes(style.overflowY!) && el.scrollHeight > el.clientHeight\r\n    },\r\n    shouldScroll (el: Element, delta: number) {\r\n      if (el.scrollTop === 0 && delta < 0) return true\r\n      return el.scrollTop + el.clientHeight === el.scrollHeight && delta > 0\r\n    },\r\n    isInside (el: Element, parent: Element): boolean {\r\n      if (el === parent) {\r\n        return true\r\n      } else if (el === null || el === document.body) {\r\n        return false\r\n      } else {\r\n        return this.isInside(el.parentNode as Element, parent)\r\n      }\r\n    },\r\n    checkPath (e: WheelEvent) {\r\n      const path = e.path || this.composedPath(e)\r\n      const delta = e.deltaY || -e.wheelDelta\r\n\r\n      if (e.type === 'keydown' && path[0] === document.body) {\r\n        const dialog = this.$refs.dialog\r\n        const selected = window.getSelection().anchorNode as Element\r\n        if (dialog && this.hasScrollbar(dialog) && this.isInside(selected, dialog)) {\r\n          return this.shouldScroll(dialog, delta)\r\n        }\r\n        return true\r\n      }\r\n\r\n      for (let index = 0; index < path.length; index++) {\r\n        const el = path[index]\r\n\r\n        if (el === document) return true\r\n        if (el === document.documentElement) return true\r\n        if (el === this.$refs.content) return true\r\n\r\n        if (this.hasScrollbar(el as Element)) return this.shouldScroll(el as Element, delta)\r\n      }\r\n\r\n      return true\r\n    },\r\n    /**\r\n     * Polyfill for Event.prototype.composedPath\r\n     */\r\n    composedPath (e: WheelEvent): EventTarget[] {\r\n      if (e.composedPath) return e.composedPath()\r\n\r\n      const path = []\r\n      let el = e.target as Element\r\n\r\n      while (el) {\r\n        path.push(el)\r\n\r\n        if (el.tagName === 'HTML') {\r\n          path.push(document)\r\n          path.push(window)\r\n\r\n          return path\r\n        }\r\n\r\n        el = el.parentElement!\r\n      }\r\n      return path\r\n    },\r\n    hideScroll () {\r\n      if (this.$vuetify.breakpoint.smAndDown) {\r\n        document.documentElement!.classList.add('overflow-y-hidden')\r\n      } else {\r\n        window.addEventListener('wheel', this.scrollListener as EventHandlerNonNull, { passive: false })\r\n        window.addEventListener('keydown', this.scrollListener as EventHandlerNonNull)\r\n      }\r\n    },\r\n    showScroll () {\r\n      document.documentElement!.classList.remove('overflow-y-hidden')\r\n      window.removeEventListener('wheel', this.scrollListener as EventHandlerNonNull)\r\n      window.removeEventListener('keydown', this.scrollListener as EventHandlerNonNull)\r\n    }\r\n  }\r\n})\r\n"],"sourceRoot":""}